<?xml version="1.0"?>
<!--
(The MIT License)

Copyright (c) 2018 Yegor Bugayenko

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the 'Software'), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title>/health</title>
    <meta name="description" content="Health check of the entire Zold network"/>
    <meta name="keywords" content="zerocracy, management, robotocracy, meritocracy"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="shortcut icon" href="https://www.zold.io/logo.png"/>
    <link href="https://cdn.rawgit.com/yegor256/tacit/gh-pages/tacit-css-1.3.0.min.css" rel="stylesheet"/>
    <link href="@@VERSION/css/health.min.css" rel="stylesheet"/>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js">
      // Should be empty
    </script>
    <script src="https://cdn.rawgit.com/yegor256/colorizejs/gh-pages/colorizejs.min.js">
      // Should be empty
    </script>
    <script src="@@VERSION/js/health.js">
      // Should be empty
    </script>
  </head>
  <body onload="health_init();">
    <section>
      <p>
        <img class="logo" src="https://www.zold.io/logo.svg"/>
      </p>
      <p>
        NScore:
        <span id="nscore">?</span>;
        Nodes:
        <span id="total_nodes">?</span>;
        CPUs:
        <span id="total_cpus">?</span>;
        Network cost: ~$<span id="total_dollars">?</span>/day.
      </p>
      <p>
        Avg remotes:
        <span id="avg_remotes">?</span>;
        Avg speed:
        <span id="avg_speed">?</span>s;
        Avg queue:
        <span id="avg_queue">?</span>;
        Confirmation time:
        <span id="lag">?</span>s
        (<span id="hops">?</span> hops).
      </p>
      <p>
        <input type="text" size="20" maxlength="16" placeholder="Wallet ID..." id="wallet" autofocus="true" tabindex="1"/>
        <input type="submit" value="Check" tabindex="2" onclick="health_check_wallet();"/>
      </p>
      <p id="head"></p>
      <table id="health">
        <colgroup>
          <col style=""/> <!-- Host -->
          <col style=""/> <!-- Port -->
          <col style="width:6em;"/> <!-- Ping -->
          <col style=""/> <!-- Flag -->
          <col style="width:10em;"/> <!-- Platform -->
          <col style=""/> <!-- CPUs -->
          <col style=""/> <!-- Memory -->
          <col style=""/> <!-- Load -->
          <col style=""/> <!-- Threads -->
          <col style=""/> <!-- Score -->
          <col style=""/> <!-- Wallets -->
          <col style=""/> <!-- Version -->
          <col style=""/> <!-- NScore -->
          <col style=""/> <!-- Remotes -->
          <col style=""/> <!-- History -->
          <col style=""/> <!-- Queue -->
          <col style=""/> <!-- QAge -->
          <col style=""/> <!-- Speed -->
          <col style=""/> <!-- Age -->
          <col style=""/> <!-- Check -->
        </colgroup>
        <thead>
          <tr>
            <th class="host">Host</th>
            <th class="port">Port</th>
            <th class="ping">Ping</th>
            <th class="flag"></th>
            <th class="platform">Platform</th>
            <th class="cpus">CPUs</th>
            <th class="memory">Mem</th>
            <th class="load">Load</th>
            <th class="threads">Threads</th>
            <th class="score">Score</th>
            <th class="wallets">Wallets</th>
            <th class="version">Version</th>
            <th class="nscore">NScore</th>
            <th class="remotes">Rmts</th>
            <th class="history">Hstr</th>
            <th class="queue">QLen</th>
            <th class="qage">QAge</th>
            <th class="speed">Spd</th>
            <th class="age">Age</th>
            <th class="wallet">Check</th>
          </tr>
        </thead>
        <tbody>
          <!-- Empty on start -->
        </tbody>
      </table>
      <p class="footnotes">
        "Host" is the IP address or a hostname of the node;
        "Port" is the TCP port the node is responding at;
        "CPUs" is the total amount of processors at the particular node;
        "Mem" (memory) is the amount of memory the core Zold process consumes on the node, in Mb;
        "Threads" is the amount of active threads vs. total threads at the node;
        "Score" is the trust score of the node it exposes currently (it is expired and not valid, if it is crossed through);
        "Wallets" is the total amount of wallets the node is holding;
        "Version" is the version of software the node runs;
        "NScore" is the total network trust score the node estimates, <a href="https://blog.zold.io/2018/07/22/nscore.html">read more</a>;
        "Rmts" (remotes) is the total amount of remote nodes the node is connected to;
        "Hstr" (history) is the amount of recently processed PUSH requests;
        "QLen" (queue length) is the amount of PUSH requests staying in the line and wating processing;
        "QAge" (queue age) is the age of the oldest wallet in the queue, in seconds;
        "Spd" (speed) is the average amount of time in seconds the node spends per each PUSH request processing;
        "Age" is the amount of hours since recent reboot of the node.
      </p>
      <p class="footnotes">
        @@VERSION
      </p>
    </section>
  </body>
</html>
